install.packages(c("randomForest", "tree"))
knitr::opts_chunk$set(echo = TRUE)
library(ISLR)
library(tree)
library(randomForest)
attach(Carseats)
set.seed(1)
train <- sample(1:nrow(Carseats), nrow(Carseats) / 2)
Carseats.train <- Carseats[train, ]
Carseats.test <- Carseats[-train, ]
tree.carseats <- tree(Sales ~ ., data = Carseats, subset = train )
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats,pretty=0,cex=0.6)
tree.pred=predict(tree.carseats, newdata = Carseats.test)
mean((tree.pred - Carseats.test$Sales)^2)
set.seed(12)
cv.carseats <- cv.tree(tree.carseats, FUN = prune.tree)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
prune.carseats <- prune.tree(tree.carseats, best = 8)
plot(prune.carseats)
text(prune.carseats, pretty = 0,cex=0.6)
yhat <- predict(prune.carseats, newdata = Carseats.test)
mean((yhat - Carseats.test$Sales)^2)
set.seed(123)
cv.tree.carseats <- cv.tree(tree.carseats)
cv.tree.carseats
plot(cv.tree.carseats)
# cv.carseats <- cv.tree(tree.carseats, FUN = prune.tree)
# cv.carseats
# par(mfrow = c(1, 2))
# plot(cv.carseats$size, cv.carseats$dev, type = "b")
# prune.carseats <- prune.tree(tree.carseats, best = 8)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((yhat - Carseats.test$Sales)^2)
set.seed(123)
cv.carseats <- cv.tree(tree.carseats, FUN = prune.tree)
cv.carseats
plot(cv.carseats)
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
prune.carseats <- prune.tree(tree.carseats, best = 8)
plot(prune.carseats)
text(prune.carseats, pretty = 0,cex=0.6)
yhat <- predict(prune.carseats, newdata = Carseats.test)
mean((yhat - Carseats.test$Sales)^2)
set.seed(123)
cv.carseats <- cv.tree(tree.carseats)
cv.carseats
plot(cv.carseats)
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
prune.carseats <- prune.tree(tree.carseats, best = 8)
plot(prune.carseats)
text(prune.carseats, pretty = 0,cex=0.6)
yhat <- predict(prune.carseats, newdata = Carseats.test)
mean((yhat - Carseats.test$Sales)^2)
library(ISLR)
attach(Carseats)
set.seed(12)
train <- sample(dim(Carseats)[1], dim(Carseats)[1] / 2)
Carseats.train <- Carseats[train, ]
Carseats.test <- Carseats[-train, ]
library(tree)
tree.carseats <- tree(Sales ~ ., data = Carseats.train)
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats,pretty=0,cex=0.6)
tree.pred=predict(tree.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales - tree.pred)^2)
set.seed(1)
train <- sample(1:nrow(Carseats), nrow(Carseats) / 2)
Carseats.train <- Carseats[train, ]
Carseats.test <- Carseats[-train, ]
tree.carseats <- tree(Sales ~ ., data = Carseats, subset = train )
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats,pretty=0,cex=0.6)
tree.pred=predict(tree.carseats, newdata = Carseats.test)
mean((tree.pred - Carseats.test$Sales)^2)
set.seed(123)
cv.carseats <- cv.tree(tree.carseats, FUN = prune.tree)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
# prune.carseats <- prune.tree(tree.carseats, best = 8)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((yhat - Carseats.test$Sales)^2)
set.seed(123)
cv.carseats <- cv.tree(tree.carseats, FUN = prune.tree)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
# prune.carseats <- prune.tree(tree.carseats, best = 8)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((yhat - Carseats.test$Sales)^2)
set.seed(123)
cv.carseats <- cv.tree(tree.carseats, FUN = prune.tree)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
# prune.carseats <- prune.tree(tree.carseats, best = 8)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((yhat - Carseats.test$Sales)^2)
set.seed(927)
train <- sample(1:nrow(Carseats), nrow(Carseats) / 2)
Carseats.train <- Carseats[train, ]
Carseats.test <- Carseats[-train, ]
tree.carseats <- tree(Sales ~ ., data = Carseats, subset = train )
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats,pretty=0,cex=0.6)
tree.pred=predict(tree.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales-tree.pred)^2)
set.seed(727)
train <- sample(1:nrow(Carseats), nrow(Carseats) / 2)
Carseats.train <- Carseats[train, ]
Carseats.test <- Carseats[-train, ]
tree.carseats <- tree(Sales ~ ., data = Carseats, subset = train )
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats,pretty=0,cex=0.6)
tree.pred=predict(tree.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales-tree.pred)^2)
set.seed(1)
train <- sample(1:nrow(Carseats), nrow(Carseats) / 2)
Carseats.train <- Carseats[train, ]
Carseats.test <- Carseats[-train, ]
tree.carseats <- tree(Sales ~ ., data = Carseats, subset = train )
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats,pretty=0,cex=0.6)
tree.pred=predict(tree.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales-tree.pred)^2)
cv.carseats <- cv.tree(tree.carseats, FUN = prune.tree)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
# prune.carseats <- prune.tree(tree.carseats, best = 18)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((yhat - Carseats.test$Sales)^2)
set.seed(1)
cv.carseats <- cv.tree(tree.carseats, FUN = prune.tree)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
# prune.carseats <- prune.tree(tree.carseats, best = 18)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((yhat - Carseats.test$Sales)^2)
set.seed(2)
train <- sample(1:nrow(Carseats), nrow(Carseats) / 2)
Carseats.train <- Carseats[train, ]
Carseats.test <- Carseats[-train, ]
tree.carseats <- tree(Sales ~ ., data = Carseats, subset = train )
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats,pretty=0,cex=0.6)
tree.pred=predict(tree.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales-tree.pred)^2)
set.seed(1)
cv.carseats <- cv.tree(tree.carseats, FUN = prune.tree)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
# prune.carseats <- prune.tree(tree.carseats, best = 18)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((yhat - Carseats.test$Sales)^2)
set.seed(123)
train <- sample(1:nrow(Carseats), nrow(Carseats) / 2)
Carseats.train <- Carseats[train, ]
Carseats.test <- Carseats[-train, ]
tree.carseats <- tree(Sales ~ ., data = Carseats, subset = train )
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats,pretty=0,cex=0.6)
tree.pred=predict(tree.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales-tree.pred)^2)
cv.carseats <- cv.tree(tree.carseats)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
# prune.carseats <- prune.tree(tree.carseats, best = 18)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((yhat - Carseats.test$Sales)^2)
cv.carseats <- cv.tree(tree.carseats)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
prune.carseats <- prune.tree(tree.carseats, best = best.size)
plot(prune.carseats)
text(prune.carseats, pretty = 0,cex=0.6)
yhat <- predict(prune.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales-yhat)^2)
cv.carseats <- cv.tree(tree.carseats)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
# prune.carseats <- prune.tree(tree.carseats, best = best.size)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((Carseats.test$Sales-yhat)^2)
cv.carseats <- cv.tree(tree.carseats)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
# prune.carseats <- prune.tree(tree.carseats, best = best.size)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((Carseats.test$Sales-yhat)^2)
cv.carseats <- cv.tree(tree.carseats)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
# prune.carseats <- prune.tree(tree.carseats, best = best.size)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((Carseats.test$Sales-yhat)^2)
cv.carseats <- cv.tree(tree.carseats)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
# prune.carseats <- prune.tree(tree.carseats, best = best.size)
# plot(prune.carseats)
# text(prune.carseats, pretty = 0,cex=0.6)
# yhat <- predict(prune.carseats, newdata = Carseats.test)
# mean((Carseats.test$Sales-yhat)^2)
cv.carseats <- cv.tree(tree.carseats)
cv.carseats
par(mfrow = c(1, 2))
plot(cv.carseats$size, cv.carseats$dev, type = "b")
plot(cv.carseats$k, cv.carseats$dev, type = "b")
best.size <- cv.carseats$size[which.min(cv.carseats$dev)]
best.size
prune.carseats <- prune.tree(tree.carseats, best = best.size)
plot(prune.carseats)
text(prune.carseats, pretty = 0,cex=0.6)
yhat <- predict(prune.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales-yhat)^2)
bag.carseats = randomForest(Sales~.,data=Carseats.train,mtry = 10, importance = TRUE)
yhat.bag <- predict(bag.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales - yhat.bag)^2)
importance(bag.carseats)
varImpPlot(bag.carseats)
set.seed(1)
bag.carseats = randomForest(Sales~.,data=Carseats.train,mtry = 10, importance = TRUE)
yhat.bag <- predict(bag.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales - yhat.bag)^2)
importance(bag.carseats)
varImpPlot(bag.carseats)
rf.carseats <- randomForest(Sales ~ ., data = Carseats.train, mtry = 3, importance = TRUE)
yhat.rf <- predict(rf.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales - yhat.rf)^2)
importance(rf.carseats)
varImpPlot(rf.carseats)
rf.carseats <- randomForest(Sales ~ ., data = Carseats.train, mtry = 5, importance = TRUE)
yhat.rf <- predict(rf.carseats, newdata = Carseats.test)
mean((Carseats.test$Sales - yhat.rf)^2)
importance(rf.carseats)
varImpPlot(rf.carseats)
