"0","library(leaps)"
"0","regfit.full = regsubsets(y ~ ., data = data.frame(x = x.train, y = y.train), "
"0","    nvmax = p)"
"0","val.errors = rep(NA, p)"
"0","x_cols = colnames(x, do.NULL = FALSE, prefix = ""x."")"
"0","for (i in 1:p) {"
"0","    coefi = coef(regfit.full, id = i)"
"0","    pred = as.matrix(x.train[, x_cols %in% names(coefi)]) %*% coefi[names(coefi) %in% "
"0","        x_cols]"
"0","    val.errors[i] = mean((y.train - pred)^2)"
"0","}"
"0","plot(val.errors, ylab = ""Training MSE"", pch = 19, type = ""b"", col = ""blue"")"
